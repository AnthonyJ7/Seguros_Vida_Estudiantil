{
  "info": {
    "name": "Seguros Vida UTPL",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "description": "Colección de pruebas para backend Seguros Vida UTPL"
  },
  "variable": [
    { "key": "base_url", "value": "http://localhost:4000/api" },
    { "key": "token", "value": "REEMPLAZA_CON_ID_TOKEN" },
    { "key": "tramite_id", "value": "" },
    { "key": "aseg_id", "value": "" }
  ],
  "item": [
    {
      "name": "Estudiantes - Verificar Elegibilidad",
      "request": {
        "method": "POST",
        "header": [
          {"key":"Authorization","value":"Bearer {{token}}"},
          {"key":"Content-Type","value":"application/json"}
        ],
        "url": {"raw": "{{base_url}}/estudiantes/verificar-elegibilidad","host":["{{base_url}}"],"path":["estudiantes","verificar-elegibilidad"]},
        "body": {"mode": "raw","raw": "{\n  \"cedula\": \"1104567890\"\n}"}
      }
    },
    {
      "name": "Trámites - Crear",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "const json = pm.response.json();",
              "if (json.idTramite) { pm.collectionVariables.set('tramite_id', json.idTramite); }"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {"key":"Authorization","value":"Bearer {{token}}"},
          {"key":"Content-Type","value":"application/json"}
        ],
        "url": {"raw": "{{base_url}}/tramites","host":["{{base_url}}"],"path":["tramites"]},
        "body": {"mode": "raw","raw": "{\n  \"cedula\": \"1104567890\",\n  \"tipo\": \"fallecimiento\",\n  \"descripcion\": \"Caso desde Postman\",\n  \"beneficiario\": {\n    \"nombreCompleto\": \"Juan Perez\",\n    \"cedula\": \"1104567891\",\n    \"relacion\": \"Padre\",\n    \"telefono\": \"0987654321\",\n    \"correo\": \"juan@example.com\"\n  }\n}"}
      }
    },
    {
      "name": "Trámites - Validar",
      "request": {
        "method": "POST",
        "header": [
          {"key":"Authorization","value":"Bearer {{token}}"}
        ],
        "url": {"raw": "{{base_url}}/tramites/{{tramite_id}}/validar","host":["{{base_url}}"],"path":["tramites","{{tramite_id}}","validar"]}
      }
    },
    {
      "name": "Trámites - Enviar Aseguradora",
      "request": {
        "method": "POST",
        "header": [
          {"key":"Authorization","value":"Bearer {{token}}"},
          {"key":"Content-Type","value":"application/json"}
        ],
        "url": {"raw": "{{base_url}}/tramites/{{tramite_id}}/enviar-aseguradora","host":["{{base_url}}"],"path":["tramites","{{tramite_id}}","enviar-aseguradora"]},
        "body": {"mode": "raw","raw": "{\n  \"idAseguradora\": \"{{aseg_id}}\"\n}"}
      }
    },
    {
      "name": "Trámites - Registrar Resultado",
      "request": {
        "method": "POST",
        "header": [
          {"key":"Authorization","value":"Bearer {{token}}"},
          {"key":"Content-Type","value":"application/json"}
        ],
        "url": {"raw": "{{base_url}}/tramites/{{tramite_id}}/resultado","host":["{{base_url}}"],"path":["tramites","{{tramite_id}}","resultado"]},
        "body": {"mode": "raw","raw": "{\n  \"aprobado\": true,\n  \"montoAprobado\": 5000,\n  \"observaciones\": \"Aprobado desde Postman\"\n}"}
      }
    },
    {
      "name": "Trámites - Confirmar Pago",
      "request": {
        "method": "POST",
        "header": [
          {"key":"Authorization","value":"Bearer {{token}}"}
        ],
        "url": {"raw": "{{base_url}}/tramites/{{tramite_id}}/pago","host":["{{base_url}}"],"path":["tramites","{{tramite_id}}","pago"]}
      }
    },
    {
      "name": "Trámites - Historial",
      "request": {
        "method": "GET",
        "header": [
          {"key":"Authorization","value":"Bearer {{token}}"}
        ],
        "url": {"raw": "{{base_url}}/tramites/{{tramite_id}}/historial","host":["{{base_url}}"],"path":["tramites","{{tramite_id}}","historial"]}
      }
    },
    {
      "name": "Notificaciones - Mis Notificaciones",
      "request": {
        "method": "GET",
        "header": [
          {"key":"Authorization","value":"Bearer {{token}}"}
        ],
        "url": {"raw": "{{base_url}}/notificaciones/mis-notificaciones","host":["{{base_url}}"],"path":["notificaciones","mis-notificaciones"]}
      }
    },
    {
      "name": "Auditoría - Por Trámite",
      "request": {
        "method": "GET",
        "header": [
          {"key":"Authorization","value":"Bearer {{token}}"}
        ],
        "url": {"raw": "{{base_url}}/auditoria/tramite/{{tramite_id}}","host":["{{base_url}}"],"path":["auditoria","tramite","{{tramite_id}}"]}
      }
    }
  ]
}
